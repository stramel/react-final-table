"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function n(){return(n=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var r=function(e){return function(n,r){var t=e(n).toUpperCase(),o=e(r).toUpperCase();return t<o?-1:t>o?1:0}},t=function(e,n,r){return n?function(){return n({row:r,value:e})}:function(){return e}},o=function(e){var n={};return e.forEach((function(e){var r={label:e.label};e.render&&(r.render=e.render),r.hidden=e.hidden,n[e.name]=r})),n},a=function(e,n,r){var t=(r-1)*n;return e.slice(t,t+n)};exports.byTextAscending=r,exports.byTextDescending=function(e){return function(n,r){var t=e(n).toUpperCase(),o=e(r).toUpperCase();return t>o?-1:t<o?1:0}},exports.useTable=function(i,u,l){var c=e.useMemo((function(){return i.map((function(e){return n({},e,{label:e.label?e.label:e.name,hidden:!!e.hidden&&e.hidden,sort:e.sort,sorted:{on:!1}})}))}),[i]),s=e.useMemo((function(){return o(c)}),[c]),d=e.useMemo((function(){return function(e,n){return e.map((function(e){var r={};return n.forEach((function(n){if(!(n.name in e))throw new Error("Invalid row data, "+n.name+" not found");r[n.name]=e[n.name]})),r}))}(u,c).map((function(e,n){return{id:n,selected:!1,hidden:!1,original:e,cells:Object.entries(e).map((function(n){var r=n[0],o=n[1];return{hidden:s[r].hidden,field:r,value:o,render:t(o,s[r].render,e)}})).filter((function(e){return!e.hidden}))}}))}),[u,c,s]),f=e.useReducer((function(e,t){switch(t.type){case"SET_ROWS":var i=[].concat(t.data);return e.sortColumn&&(i=function(e,n,t){var o=null,a=[].concat(e);return t.forEach((function(t){if(n===t.name){o=t.sorted.asc;var i=t.sort||r((function(e){return e.original[n]}));a=e.sort((function(e,n){var r=i(e,n);return o?r:-1*r}))}})),a}(t.data,e.sortColumn,e.columns)),e.paginationEnabled&&(i=a(i,e.pagination.perPage,e.pagination.page)),n({},e,{rows:i,originalRows:t.data});case"NEXT_PAGE":var u=e.pagination.page+1;return n({},e,{rows:a(e.originalRows,e.pagination.perPage,u),pagination:n({},e.pagination,{page:u,canNext:u*e.pagination.perPage<e.originalRows.length,canPrev:1!==u})});case"PREV_PAGE":var l=1===e.pagination.page?1:e.pagination.page-1;return n({},e,{rows:a(e.originalRows,e.pagination.perPage,l),pagination:n({},e.pagination,{page:l,canNext:l*e.pagination.perPage<e.originalRows.length,canPrev:1!==l})});case"TOGGLE_SORT":if(!(t.columnName in e.columnsByName))throw new Error("Invalid column, "+t.columnName+" not found");var c=null,s=[],d=e.columns.map((function(o){if(t.columnName===o.name){c=void 0!==t.isAscOverride?t.isAscOverride:void 0===o.sorted.asc||!o.sorted.asc;var a=o.sort||r((function(e){return e.original[t.columnName]}));return s=e.rows.sort((function(e,n){var r=a(e,n);return c?r:-1*r})),n({},o,{sorted:{on:!0,asc:c}})}return n({},o,{sorted:{on:!1,asc:!1}})}));return n({},e,{columns:d,rows:s,sortColumn:t.columnName,columnsByName:o(d)});case"GLOBAL_FILTER":var f=t.filter(e.originalRows),g={};return e.selectedRows.forEach((function(e){g[e.id]=!!e.selected})),n({},e,{rows:f.map((function(e){return g[e.id]?n({},e,{selected:g[e.id]}):n({},e)})),filterOn:!0});case"SELECT_ROW":var p=n({},e);return p.rows=p.rows.map((function(e){var r=n({},e);return r.id===t.rowId&&(r.selected=!r.selected),r})),p.originalRows=p.originalRows.map((function(e){var r=n({},e);return r.id===t.rowId&&(r.selected=!r.selected),r})),p.selectedRows=p.originalRows.filter((function(e){return e.selected})),p.toggleAllState=p.selectedRows.length===p.rows.length,p;case"SEARCH_STRING":var w=n({},e);return w.rows=w.originalRows.filter((function(e){return e.cells.filter((function(e){return e.value.includes(t.searchString)})).length>0})),w;case"TOGGLE_ALL":var m=n({},e),v={},R=e.selectedRows.length<e.rows.length;return m.rows=m.rows.map((function(e){return v[e.id]=R,n({},e,{selected:R})})),m.toggleAllState=R,m.originalRows=m.originalRows.map((function(e){return e.id in v?n({},e,{selected:v[e.id]}):n({},e)})),m.selectedRows=m.originalRows.filter((function(e){return e.selected})),m;default:throw new Error("Invalid reducer action")}}),{columns:c,columnsByName:s,originalRows:d,rows:d,selectedRows:[],toggleAllState:!1,filterOn:!(null==l||!l.filter),sortColumn:null,paginationEnabled:!(null==l||!l.pagination),pagination:{page:1,perPage:10,canNext:!0,canPrev:!1,nextPage:function(){},prevPage:function(){}}}),g=f[0],p=f[1];g.pagination.nextPage=e.useCallback((function(){p({type:"NEXT_PAGE"})}),[p]),g.pagination.prevPage=e.useCallback((function(){return p({type:"PREV_PAGE"})}),[p]),e.useEffect((function(){p({type:"SET_ROWS",data:d})}),[d]);var w=e.useMemo((function(){return[].concat(g.columns.map((function(e){return n({},e,{render:(r=e.label?e.label:e.name,t=e.headerRender,t?function(){return t({label:r})}:function(){return r})});var r,t})))}),[g.columns]),m=null==l?void 0:l.filter;return e.useEffect((function(){m&&p({type:"GLOBAL_FILTER",filter:m})}),[m]),{headers:w.filter((function(e){return!e.hidden})),rows:g.rows,originalRows:g.originalRows,selectedRows:g.selectedRows,dispatch:p,selectRow:function(e){return p({type:"SELECT_ROW",rowId:e})},toggleAll:function(){return p({type:"TOGGLE_ALL"})},toggleSort:function(e,n){return p({type:"TOGGLE_SORT",columnName:e,isAscOverride:n})},setSearchString:function(e){return p({type:"SEARCH_STRING",searchString:e})},pagination:g.pagination,toggleAllState:g.toggleAllState}};
//# sourceMappingURL=react-final-table.cjs.production.min.js.map
